<!DOCTYPE html>
<html><head>
<title>SmartHousePC Devices View Page</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="HTML KickStart is a ultraâ€“lean set of HTML5, CSS, and jQuery (javascript) files, layouts, and elements designed to give you a headstart and save you a lot of hours on your next web project." />
<meta name="copyright" content="Joshua Gatcke 99lime.com All Rights Reserved" />
<script src="js/sorttable.js"></script>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<link rel="stylesheet" type="text/css" href="style.css" media="all" /> 
<link rel="stylesheet" type="text/css" href="css/w3c.css" media="all" /> 
<link rel="stylesheet" type="text/css" href="css/kickstart.css" media="all" />               <!--  KICKSTART -->
<link rel="stylesheet" type="text/css" href="header.css" media="all" />        <!--   CUSTOM STYLES
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="js/kickstart.js"></script>                                  <!-- KICKSTART -->
</head><body>
<!-- ===================================== END HEADER ===================================== -->
<!-- ===================================== NAVIGATION BAR ===================================== -->


	<nav class="navbar">
		
			
			
			<a class="hide-phone" id="logo" href="http://duinocloud.org" title="Go to duinocloud eshop"><i class="fa fa-angle-right" style="float:right"> duino<span>Cloud.org</span></a></i>

			<ul  style="overflow:hidden" >
			<li class="hide-phone" ><a href="index.html" style="float:left" title="Go back to SmartHouse App Landing Page"><span>HTML</span>SmartHouse</a></li>

			
			<li class="show-phone" ><a href="index.html" style="float:right" title="Go back to SmartHouse App Landing Page"><i class="fa fa-home "></i></a></li>

			<li><a href="device_add.html" style="float:right" title="Add devices to be monitored or controlled"><i class="fa fa-plus "></i></a></li>
			

			<li><a href="device_config.html" style="float:right" title="Setup and configure"><i class="fa fa-gear "></i></a></li>
			<li><a href="help.html" style="float:right" title="Get Help"><i class="fa fa-info "></i></a></li>	
			<li><a href="cloud_connect.html" style="float:right" title="Connect to your Monitoring Cloud"><i class="fa fa-cloud "></i></a></li>

			</ul>
			
  

			
		
	</nav> 


<!-- ===================================== END NAVIGATION BAR ===================================== -->

	<div class="callout callout-top w3-table-container">
	  <h4>Table Device List</h4>

		<div class="clear"></div><br/>
		<div id="status-bar">
			<p id="status-msg"> ... </p>
		</div>
		<div class="clear"></div><br/>	 

	  <table id="devices" class="sortable w3-table-all w3-large">
	    <thead>
	      <tr class="w3-light-grey w3-hover-grey">
	        <th>Name</th>
	        <th>Location</th>
	        <th>Status</th>
	      </tr>
	    </thead>
	    <tr class="w3-hover-grey">
	      <td>Temp Sensor</td>
	      <td>Kitchen</td>
	      <td>23 Degrees Celsius</td>
	    </tr>
	    <tr class="w3-hover-grey">
	      <td>Light</td>
	      <td>Kitchen</td>
	      <td>Off</td>
	    </tr>
	    <tr class="w3-hover-grey">
	      <td>Heat</td>
	      <td>House</td>
	      <td>On</td>
	    </tr>
	  </table>
	</div>

		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
		<div class="clear"></div><br/>

    <div>

		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
		<a class="button red large" href="https://github.com/lballaty/smarthouse"><i class="fa fa-cloud-download"></i> Download Apps (Github)</a> 
		<span style="white-space: nowrap;">
		<a class="button blue large" href=""><i class="fa fa-facebook"></i></a>
		<a class="button blue large" href=""><i class="fa fa-bell"></i></a>
		<a class="button blue large" href="mailto:liborballaty@gmail.com"><i class="fa fa-envelope"></i></a></span><br />
		<p>Downloaded a few times</p> 
		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
		<div class="clear"></div><br/>
	</div>


 

</body>
<script>
      var socket = io('/iot');
	  
	  // set connection actions
	  socket.on('connect', onConnect);
	  socket.on('connect_error', onConnectError);
	  socket.on('error', onError);
	  //  <tr class="w3-hover-grey">
	  //    <td>Temp Sensor</td>   << p1
	  //    <td>Kitchen</td>
	  //    <td>23 Degrees Celsius</td>
	  //  </tr>
	  // action to be performed on receiving 
      socket.on('value', setValue);
	  
	  function setValue(msg) {
		devArdID = msg.devid + "_" + msg.ardid;
		console.log('got value');
		if (document.getElementById(devArdID + '_value') == null) {
			/* this is a new device so whole div structure needs to be created */
			p1 = '<tr class="w3-hover-grey"><td>' + msg.devType + '</td>';
			pMain = '<td>' + devArdID + '</td>';
			p2 = '<td id="' + devArdID + '_value">' + msg.value + '</td></tr>';
			$("#devices").append(p1 + pMain + p2);
		} else {
			/* the device already reported, structre needs to be filled in with new data */
			$("#" + devArdID + "_value").text(msg.value);
		}
      }
	  
	  // color the status-bar div on successful connection
	  function onConnect(msg) {
		console.log("connected to server.");
		$("#status-bar").css( { "background-color": "#1CD935", "border": "3px solid #169126", "width": "95%" } );
		$("#status-msg").text("Connected to server.");
		$("#status-msg").css( { "margin": "5px" });
	  }
	  
	  // color the status-bar on connection error
	  function onConnectError(msg) {
		console.log("Connection Error!");
		$("#status-bar").css( { "background-color": "#F02626", "border": "3px solid #911631", "width": "95%" } );
		$("#status-msg").text("Disconnected from server: " + msg);
		$("#status-msg").css( { "margin": "5px" });
	  }
	  
	  function onError(msg) {
		console.log("other error: " + msg);
		$("#status-bar").css( { "background-color": "#F02626", "border": "3px solid #911631", "width": "95%" } );
		$("#status-msg").text("Disconnected from server: " + msg);
		$("#status-msg").css( { "margin": "5px" });
	  }
	  
    </script>
</html>
